# 野火组织通讯录服务

野火组织通讯录服务包括后端服务和管理页面。

## 后端服务
在后端服务中，提供两种类型的API，一种给管理页面用；另外一种给客户端查询使用。管理页面根据后台数据库中的用户/密码来登录。客户端在im client中取应用code，然后使用code来登录。管理页面可以修改组织通讯录数据，客户端只能查询。

## 数据结构
系统中有3个数据结构，分别是组织、员工和关系。关系数据比较特殊，在关系数据中记录员工与组织的层级关系。比如一个员工甲的组织路径为"公司/技术部/移动端/Android"，那么数据结构就存在下面4行

|  员工   | 部门  |  层级  | 上级部门 | 直属 |
|  ----  | ----  | ----  | ---- | ---- |
| 甲  | 公司 |  0  |  NULL | false |
| 甲  | 技术部 |  1  |  公司 | false |
| 甲  | 移动端 |  2  |  技术部 | false |
| 甲  | Android |  3  |  移动端 | true |

可以看出数据中存在大量的冗余数据，数据维护难度较大，但带来的好处就是查询比较方便和高效。

员工支持多部门，一个员工可以在多个部门中任职。

## 客户端使用
客户端登录成功以后，可以调用各个查询接口。一般在进入到通讯录界面，可以调取获取根组织的方法，获取公司。然后点开公司再一级一级地展开数据。

在用户的详情界面，可以查询用户的组织关系，这样就能展示用户的组织路径。点击具体路径就可以获取对应组织的信息详情。

客户端可以本地缓存数据，在需要显示时先使用缓存，再去服务器查询，如果有更新再刷新页面。


## 测试数据
后端有接口获取导入模版，模版中有示例人员信息，可以导入后进行测试。
